---
import '../styles/global.css';

interface Props {
  title: string;
  description?: string;
}

const { title, description = 'A practical reference for GitHub Copilot CLI users' } = Astro.props;
const rawBase = import.meta.env.BASE_URL;
const base = rawBase.endsWith('/') ? rawBase : `${rawBase}/`;
---

<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <title>{title}</title>
    <script is:inline>
      (() => {
        const savedTheme = localStorage.getItem('theme');
        document.documentElement.dataset.theme = savedTheme === 'light' ? 'light' : 'dark';
      })();
    </script>
  </head>
  <body>
    <header class="site-shell site-header">
      <a href={base} class="brand">GitHub Copilot CLI Handbook</a>
      <nav class="site-nav">
        <a href={`${base}instruction-file-surface`}>Instruction File Surface</a>
        <a href={`${base}slash-commands`}>Slash Commands</a>
        <a href={`${base}command-line-arguments`}>Command Line Arguments</a>
        <a href={`${base}mcp-configuration-files`}>MCP Configuration Files</a>
        <a href="https://github.com/aosama/copilot-cli-handbook" target="_blank" rel="noreferrer"
          >GitHub</a
        >
        <button id="theme-toggle" type="button" aria-label="Dark mode">Dark mode</button>
      </nav>
    </header>

    <main class="site-shell site-main">
      <slot />
    </main>

    <footer class="site-shell site-footer">
      <p>Built with Astro and Markdown content.</p>
    </footer>

    <script is:inline>
      const toggleButton = document.getElementById('theme-toggle');
      if (toggleButton) {
        const setToggleLabel = () => {
          const currentTheme = document.documentElement.dataset.theme;
          const label = currentTheme === 'dark' ? 'Light mode' : 'Dark mode';
          toggleButton.textContent = label;
          toggleButton.setAttribute('aria-label', label);
        };

        setToggleLabel();

        toggleButton.addEventListener('click', () => {
          const currentTheme = document.documentElement.dataset.theme;
          const nextTheme = currentTheme === 'dark' ? 'light' : 'dark';
          document.documentElement.dataset.theme = nextTheme;
          localStorage.setItem('theme', nextTheme);
          setToggleLabel();
        });
      }
    </script>
  </body>
</html>
